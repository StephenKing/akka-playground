akka {
  loglevel = "DEBUG"
  loggers = ["akka.testkit.TestEventListener"]

  log-config-on-start = true

  actor {
    provider = cluster

    deployment {
      /number-producer/consumer-router {
        router = round-robin-pool
        routees.paths = ["/user/number-consumer"]
        cluster {
          enabled = on
          allow-local-routees = on
          use-role = consumer
        }
      }
    }
  }

  remote {
    enabled-transports = ["akka.remote.netty.tcp"]
    netty.tcp {
//      hostname = "127.0.0.1"
      hostname = ${?NOMAD_IP_akka}
//      port = 0
      port = ${?NOMAD_PORT_akka}
      # There is also NOMAD_HOST_PORT_akka and netty.tcp.bind-port. Figure out, if we need this
    }
  }

  cluster {
    # must be overriden using parameter
    seed-nodes = [
      "akka.tcp://number-actors@"${akka.remote.netty.tcp.hostname}":"${akka.remote.netty.tcp.port}
    ]

    # must be overriden using parameter
    # roles = ["seed"]

    roles = [${AKKA_CLUSTER_ROLE}]

    role {
      seed.min-nr-of-members = 1
    }
  }
}
